clear all;
clc
% time BHP oRate gRate
gprsInjOld = [0         600         0           0           0         
1         600         0           0           -861.857  
2         600         0           0           -518.175  
3.33021   600         0           0           -456.816  
5.30761   600         0           0           -511.796  
7.99371   600         0           0           -607.141  
10.8857   600         0           0           -713.698  
14.5041   600         0           0           -819.207  
18.2858   600         0           0           -910.072  
22.9539   600         0           0           -988.871  
27.8614   600         0           0           -1037.07  
33.99     600         0           0           -1077.42  
39.8857   600         0           0           -1100.04  
46.4433   600         0           0           -1109.26  
53.8336   600         0           0           -1112.54  
60.3282   600         0           0           -1113.58  
66.7981   600         0           0           -1112.86  
73.3157   600         0           0           -1110.91  
80.4751   600         0           0           -1107.79  
87.9141   600         0           0           -1103.44  
95.9725   600         0           0           -1099.22  
104.137   600         0           0           -1089.15  
111.46    600         0           0           -1067.64  
119.139   600         0           0           -1031.2   
126.8     600         0           0           -978.105  
135.478   600         0           0           -903.735  
144.632   600         0           0           -812.548  
154.942   600         0           0           -726.725  
169.033   600         0           0           -662.338  
186.906   600         0           0           -633.903  
206.737   600         0           0           -629.3    
226.236   600         0           0           -626.194  
242.274   600         0           0           -622.584  
257.421   600         0           0           -619.325  
272.274   600         0           0           -612.657  
287.405   600         0           0           -581.766  
305.616   600         0           0           -519.556  
325.616   600         0           0           -478.712  
345.616   600         0           0           -462.202  
365.616   600         0           0           -454.046  
385.616   600         0           0           -448.974  
405.616   600         0           0           -445.652  
425.616   600         0           0           -444.467  
445.616   600         0           0           -443.912  
465.616   600         0           0           -444.293  
485.616   600         0           0           -445.339  
505.616   600         0           0           -446.355  
525.616   600         0           0           -447.334  
545.616   600         0           0           -448.699  
565.616   600         0           0           -449.935  
585.616   600         0           0           -451.15   
605.616   600         0           0           -453.2    
625.616   600         0           0           -455.055  
645.616   600         0           0           -456.724  
665.616   600         0           0           -458.204  
685.616   600         0           0           -460.08   
705.616   600         0           0           -461.979  
725.616   600         0           0           -463.799  
745.616   600         0           0           -465.571  
765.616   600         0           0           -467.317  
785.616   600         0           0           -469.077  
805.616   600         0           0           -471.431  
825.616   600         0           0           -473.759  
845.616   600         0           0           -476.018  
865.616   600         0           0           -478.201  
885.616   600         0           0           -480.304  
905.616   600         0           0           -482.317  
925.616   600         0           0           -484.736  
945.616   600         0           0           -487.172  
965.616   600         0           0           -489.48   
985.616   600         0           0           -491.666  
1005.62   600         0           0           -493.739  
1025.62   600         0           0           -495.696  
1045.62   600         0           0           -497.531  
1065.62   600         0           0           -499.268  
1085.62   600         0           0           -501.248  
1105.62   600         0           0           -503.291  
1125.62   600         0           0           -505.232  
1145.62   600         0           0           -507.066  
1165.62   600         0           0           -508.822  
1185.62   600         0           0           -510.506  
1205.62   600         0           0           -512.112  
1225.62   600         0           0           -513.637  
1245.62   600         0           0           -515.061  
1265.62   600         0           0           -516.416  
1285.62   600         0           0           -517.722  
1305.62   600         0           0           -518.976  
1325.62   600         0           0           -520.339  
1345.62   600         0           0           -521.827  
1365.62   600         0           0           -523.29   
1385.62   600         0           0           -524.691  
1405.62   600         0           0           -526.012  
1425.62   600         0           0           -527.279  
1445.62   600         0           0           -528.503  
1465.62   600         0           0           -529.691  
1485.62   600         0           0           -530.845  
1505.62   600         0           0           -531.965  
1525.62   600         0           0           -533.048  
1545.62   600         0           0           -534.095  
1565.62   600         0           0           -535.097  
1585.62   600         0           0           -536.039  
1605.62   600         0           0           -536.923  
1625.62   600         0           0           -537.777  
1645.62   600         0           0           -538.61   
1665.62   600         0           0           -539.425  
1685.62   600         0           0           -540.221  
1705.62   600         0           0           -540.999  
1725.62   600         0           0           -541.869  
1745.62   600         0           0           -542.841  
1765.62   600         0           0           -543.82   
1785.62   600         0           0           -544.783  
1805.62   600         0           0           -545.722  
1825.62   600         0           0           -546.632  
1845.62   600         0           0           -547.504  
1865.62   600         0           0           -548.315  
1885.62   600         0           0           -549.094  
1905.62   600         0           0           -549.854  
1925.62   600         0           0           -550.602  
1945.62   600         0           0           -551.338  
1965.62   600         0           0           -552.062  
1985.62   600         0           0           -552.768  
2000      600         0           0           -553.266  
];

%   t       BHP	     q(Gas)       q(Oil)    q(Water)
% (days)   (psia)    (MSCF/day)   (STB/day)  (STB/day)
gprsProdOld = [0         400         0           0           0         
1         400         987.67493   188.533     0.000725576
2         400         982.69569   142.833     0.000861243
3.33021   400         982.4642    102.917     0.000939491
5.30761   400         957.90129   61.9156     0.000980391
7.99371   400         887.64606   27.4035     0.000947256
10.8857   400         786.33063   7.20502     0.000849687
14.5041   400         650.24913   0           0.000699248
18.2858   400         524.42909   0           0.000551311
22.9539   400         412.07014   0           0.00041122
27.8614   400         330.27999   0           0.000308243
33.99     400         270.27484   0           0.000230445
39.8857   400         235.3551    0           0.000183401
46.4433   400         210.68015   0           0.000149413
53.8336   400         192.60315   0           0.000123566
60.3282   400         188.71992   0           0.000111262
66.7981   400         188.61564   0           0.000102986
73.3157   400         187.84758   0           9.58226e-005
80.4751   400         187.20856   0           8.94535e-005
87.9141   400         186.76393   0           8.3984e-005
95.9725   400         186.345     0           7.92161e-005
104.137   400         180.60987   0           8.40303e-005
111.46    400         174.6185    0           0.000113594
119.139   400         164.60514   19.7446     0.000155106
126.8     400         157.5734    58.1654     0.000185187
135.478   400         148.0968    124.296     0.000175476
144.632   400         133.64113   226.536     9.31488e-005
154.942   400         122.20826   348.745     0         
169.033   400         119.82407   456.167     0         
186.906   400         121.28002   516.874     0         
206.737   400         122.76508   545.016     0         
226.236   400         122.12122   554.485     0         
242.274   400         121.63817   557.166     0         
257.421   400         120.81928   556.309     0.00113001
272.274   400         119.0582    549.632     0.147424  
287.405   400         111.15237   513.402     3.88153   
305.616   400         95.182654   439.368     32.5796   
325.616   400         80.164106   369.896     76.5236   
345.616   400         70.319185   324.435     110.041   
365.616   400         63.652996   293.722     135.436   
385.616   400         58.259621   268.881     157.385   
405.616   400         53.641123   247.572     177.207   
425.616   400         49.727993   229.504     195.663   
445.616   400         46.290818   213.643     212.316   
465.616   400         43.305906   199.896     227.628   
485.616   400         40.689875   187.881     241.722   
505.616   400         38.320172   177.024     254.511   
525.616   400         36.16402    167.158     266.195   
545.616   400         33.926954   156.92      278.674   
565.616   400         31.633773   146.411     291.308   
585.616   400         29.456307   136.427     303.351   
605.616   400         27.588754   127.869     314.702   
625.616   400         25.896875   120.106     324.971   
645.616   400         24.371934   113.098     334.233   
665.616   400         23.039558   106.97      342.352   
685.616   400         21.883821   101.649     350.004   
705.616   400         20.811731   96.7062     357.26    
725.616   400         19.784263   91.9619     364.221   
745.616   400         18.781295   87.325      371.016   
765.616   400         17.81138    82.8364     377.626   
785.616   400         16.861893   78.4388     384.15    
805.616   400         15.991005   74.4035     390.889   
825.616   400         15.134633   70.4331     397.518   
845.616   400         14.320902   66.6598     403.863   
865.616   400         13.549646   63.0825     409.921   
885.616   400         12.810531   59.6532     415.737   
905.616   400         12.12656    56.4789     421.186   
925.616   400         11.508365   53.6099     426.722   
945.616   400         10.918243   50.8706     432.126   
965.616   400         10.374702   48.3474     437.164   
985.616   400         9.8644581   45.9785     441.914   
1005.62   400         9.3840986   43.748      446.401   
1025.62   400         8.9348295   41.6616     450.615   
1045.62   400         8.5247854   39.7573     454.511   
1065.62   400         8.1397765   37.9689     458.184   
1085.62   400         7.7903029   36.3456     461.927   
1105.62   400         7.4576704   34.8001     465.645   
1125.62   400         7.1474019   33.3584     469.145   
1145.62   400         6.8574841   32.011      472.438   
1165.62   400         6.5811711   30.7265     475.584   
1185.62   400         6.3167508   29.497      478.597   
1205.62   400         6.0657548   28.3296     481.467   
1225.62   400         5.8285505   27.2261     484.185   
1245.62   400         5.612331    26.2202     486.696   
1265.62   400         5.4082348   25.2705     489.079   
1285.62   400         5.2118737   24.3565     491.374   
1305.62   400         5.0243635   23.4835     493.572   
1325.62   400         4.8525062   22.6833     495.804   
1345.62   400         4.6910211   21.9313     498.109   
1365.62   400         4.5321366   21.1911     500.373   
1385.62   400         4.3810727   20.4872     502.535   
1405.62   400         4.241258    19.8356     504.561   
1425.62   400         4.1078961   19.214      506.499   
1445.62   400         3.9790914   18.6134     508.373   
1465.62   400         3.8541038   18.0305     510.192   
1485.62   400         3.7327939   17.4645     511.958   
1505.62   400         3.6152447   16.916      513.671   
1525.62   400         3.5014879   16.3851     515.328   
1545.62   400         3.3915134   15.8717     516.93    
1565.62   400         3.2868042   15.3828     518.461   
1585.62   400         3.1897384   14.9295     519.892   
1605.62   400         3.1003393   14.512      521.228   
1625.62   400         3.0143773   14.1104     522.516   
1645.62   400         2.9305376   13.7187     523.773   
1665.62   400         2.8484746   13.3352     525.002   
1685.62   400         2.7681527   12.9598     526.205   
1705.62   400         2.6896129   12.5926     527.379   
1725.62   400         2.6181535   12.2585     528.613   
1745.62   400         2.5511874   11.9454     529.927   
1765.62   400         2.4834399   11.6286     531.249   
1785.62   400         2.4166544   11.3162     532.549   
1805.62   400         2.3514737   11.0112     533.818   
1825.62   400         2.2884451   10.7163     535.046   
1845.62   400         2.2282991   10.4349     536.222   
1865.62   400         2.1736013   10.1789     537.31    
1885.62   400         2.1213617   9.93438     538.352   
1905.62   400         2.0703888   9.69578     539.371   
1925.62   400         2.0202475   9.46105     540.372   
1945.62   400         1.970816    9.22962     541.359   
1965.62   400         1.9221909   9.00194     542.329   
1985.62   400         1.8748151   8.7801      543.275   
2000      400         1.8414318   8.62376     543.942   
];

%  TIME         YEARS        FOPR         FOIR         FWIR         FWPR         FGPR         FGIR         WGOR         WBHP         
%  DAYS         YEARS        STB/DAY      STB/DAY      STB/DAY      STB/DAY      MSCF/DAY     MSCF/DAY     MSCF/STB     PSIA         

% TIME         YEARS        FOPR         FGPR         FGIR         FWPR         FWIR         WBHP         WBHP         BSOIL        
%  DAYS         YEARS        STB/DAY      MSCF/DAY     MSCF/DAY     STB/DAY      STB/DAY      PSIA         PSIA                      
%                                                                                             P            I                         
                                                                                                                      
ecl = [1.000000     0.002738     170.8767     903.0549            0     1.772950     825.4114     400.0000     600.0000     0.473420     
 2.000000     0.005476     131.0126     897.2959            0     1.583643     503.8109     400.0000     600.0000     0.448716     
 3.000000     0.008214     103.7711     900.1786            0     1.450289     447.3962     400.0000     600.0000     0.427778     
 4.232995     0.011589     77.56336     890.8461            0     1.304622     475.0600     400.0000     600.0000     0.404642     
 5.908514     0.016177     51.18825     872.8062            0     1.135558     534.0337     400.0000     600.0000     0.375937     
 7.392818     0.020240     32.64950     841.3089            0     0.994060     587.8042     400.0000     600.0000     0.351101     
 8.886045     0.024329     19.93866     798.3750            0     0.870503     646.4364     400.0000     600.0000     0.330163     
 10.54885     0.028881     9.735104     747.8344            0     0.751202     710.2166     400.0000     600.0000     0.308854     
 12.64378     0.034617     1.256589     678.9258            0     0.623502     778.3791     400.0000     600.0000     0.285019     
 14.48445     0.039656            0     613.1135            0     0.526414     831.6989     400.0000     600.0000     0.266625     
 16.37331     0.044828            0     549.0338            0     0.443527     882.6923     400.0000     600.0000     0.249443     
 18.58734     0.050889            0     484.5509            0     0.366343     936.5701     400.0000     600.0000     0.232092     
 21.26414     0.058218            0     419.3017            0     0.294620     988.9652     400.0000     600.0000     0.213622     
 23.61879     0.064665            0     372.8412            0     0.246723     1023.052     400.0000     600.0000     0.199512     
 26.21882     0.071783            0     330.1155            0     0.205104     1047.755     400.0000     600.0000     0.185593     
 29.50061     0.080768            0     290.6478            0     0.167905     1072.737     400.0000     600.0000     0.170510     
 33.24409     0.091017            0     260.7845            0     0.139337     1099.432     400.0000     600.0000     0.156139     
 37.32130     0.102180            0     237.3637            0     0.117094     1118.140     400.0000     600.0000     0.142416     
 42.31938     0.115864            0     217.5002            0     0.098085     1128.327     400.0000     600.0000     0.128705     
 47.30812     0.129523            0     200.5961            0     0.083231     1130.865     400.0000     600.0000     0.117546     
 52.96901     0.145021            0     189.9537            0     0.072221     1134.450     400.0000     600.0000     0.107058     
 58.54262     0.160281            0     187.6934            0     0.065995     1135.024     400.0000     600.0000     0.098765     
 64.95221     0.177829            0     187.7769            0     0.060908     1133.924     400.0000     600.0000     0.091431     
 71.95675     0.197007            0     187.0876            0     0.056221     1131.529     400.0000     600.0000     0.085552     
 78.93990     0.216126            0     186.4836            0     0.052429     1128.655     400.0000     600.0000     0.081271     
 85.76247     0.234805            0     185.9425            0     0.049375     1123.779     400.0000     600.0000     0.078083     
 93.30396     0.255452            0     184.1116            0     0.046346     1118.972     400.0000     600.0000     0.075704     
 101.7939     0.278696            0     178.7140            0     0.052449     1107.303     400.0000     600.0000     0.150010     
 110.3344     0.302079     3.005510     171.9584            0     0.078976     1079.644     400.0000     600.0000     0.318098     
 118.5159     0.324479     27.44979     159.4646            0     0.121666     1034.757     400.0000     600.0000     0.462386     
 127.3757     0.348736     78.22962     149.7109            0     0.183415     963.4736     400.0000     600.0000     0.576057     
 137.3757     0.376114     175.9291     134.8080            0     0.266215     860.3838     400.0000     600.0000     0.675161     
 146.4621     0.400991     297.8675     116.1516            0     0.334017     762.9620     400.0000     600.0000     0.750506     
 155.9302     0.426914     389.6487     116.0298            0     0.387427     695.2063     400.0000     600.0000     0.786259     
 165.9302     0.454292     457.9819     121.7780            0     0.420952     647.1496     400.0000     600.0000     0.809177     
 176.9302     0.484409     498.2515     118.0723            0     0.425572     634.6680     400.0000     600.0000     0.836378     
 186.8203     0.511486     520.8673     119.7719            0     0.427227     628.4611     400.0000     600.0000     0.852325     
 196.7497     0.538671     531.8260     120.0509            0     0.425960     628.4335     400.0000     600.0000     0.862065     
 204.4225     0.559678     536.1945     119.8332            0     0.419261     628.6284     400.0000     600.0000     0.866930     
 211.9096     0.580177     539.0762     119.4911            0     0.425836     626.7896     400.0000     600.0000     0.866810     
 221.9096     0.607555     541.1836     119.2341            0     0.424977     624.0591     400.0000     600.0000     0.866893     
 228.8161     0.626464     541.7571     118.9435            0     0.423089     622.7285     400.0000     600.0000     0.866967     
 235.2527     0.644087     541.6915     118.6096            0     0.420341     621.4755     400.0000     600.0000     0.867050     
 242.7838     0.664706     540.8132     118.1203            0     0.418984     619.6713     400.0000     600.0000     0.867073     
 250.2015     0.685014     536.5067     116.9975            0     0.532371     616.4270     400.0000     600.0000     0.863578     
 257.5377     0.705100     528.7002     115.2014            0     0.868745     609.4183     400.0000     600.0000     0.853444     
 266.6159     0.729955     496.2850     108.0443            0     5.463879     586.8781     400.0000     600.0000     0.800573     
 276.4629     0.756914     451.2184     98.38297            0     21.99984     549.9891     400.0000     600.0000     0.728293     
 287.4629     0.787031     401.9518     87.68364            0     53.87564     505.4872     400.0000     600.0000     0.653701     
 298.4629     0.817147     368.2603     80.34254            0     77.32966     486.2652     400.0000     600.0000     0.613741     
 310.4629     0.850001     337.9243     73.71580            0     100.3418     474.8034     400.0000     600.0000     0.580440     
 324.4629     0.888331     312.0244     68.06032            0     120.4777     467.6429     400.0000     600.0000     0.553803     
 342.4629     0.937612     288.2034     62.84673            0     140.7227     462.1183     400.0000     600.0000     0.529416     
 364.4629     0.997845     263.8659     57.52633            0     164.4460     455.6855     400.0000     600.0000     0.503395     
 384.4629     1.052602     243.4078     53.05629            0     183.2436     454.4826     400.0000     600.0000     0.482809     
 405.4629     1.110097     226.2364     49.32073            0     202.8026     451.8481     400.0000     600.0000     0.463747     
 428.4629     1.173067     208.9355     45.55118            0     220.2544     453.0352     400.0000     600.0000     0.445895     
 452.4629     1.238776     194.6307     42.42405            0     238.1160     452.9939     400.0000     600.0000     0.429499     
 478.4629     1.309960     180.3906     39.30322            0     254.5217     455.4454     400.0000     600.0000     0.413811     
 503.4629     1.378406     168.8153     36.74921            0     268.9657     456.9759     400.0000     600.0000     0.400573     
 529.4629     1.449590     157.2377     34.20131            0     284.9114     457.4609     400.0000     600.0000     0.386487     
 559.4629     1.531726     142.5699     30.97944            0     302.0461     460.8153     400.0000     600.0000     0.369618     
 589.4629     1.613861     129.3588     28.08248            0     319.7929     462.6100     400.0000     600.0000     0.353191     
 619.4629     1.695997     118.0878     25.60763            0     334.8337     466.2749     400.0000     600.0000     0.338703     
 649.4629     1.778133     108.6098     23.53318            0     347.8303     468.7550     400.0000     600.0000     0.326216     
 679.4629     1.860268     100.6014     21.78146            0     359.4635     471.4261     400.0000     600.0000     0.315080     
 709.4629     1.942404     93.54277     20.24165            0     370.1532     474.3010     400.0000     600.0000     0.304664     
 739.4629     2.024539     87.05129     18.82766            0     380.1458     477.0597     400.0000     600.0000     0.294898     
 769.4629     2.106675     80.60934     17.42711            0     389.9627     479.7025     400.0000     600.0000     0.285094     
 799.4629     2.188810     74.96276     16.20056            0     399.5910     482.3066     400.0000     600.0000     0.275832     
 829.4629     2.270946     69.21584     14.95371            0     409.2148     486.2774     400.0000     600.0000     0.265858     
 859.4629     2.353081     63.92922     13.80707            0     418.4655     489.6382     400.0000     600.0000     0.256428     
 889.4629     2.435217     59.11295     12.76299            0     427.0559     492.8596     400.0000     600.0000     0.247669     
 919.4629     2.517352     54.59554     11.78417            0     435.2428     495.8848     400.0000     600.0000     0.239240     
 949.4629     2.599488     50.75738     10.95248            0     443.1409     499.6484     400.0000     600.0000     0.231048     
 979.4629     2.681623     47.08560     10.15721            0     450.7329     503.1482     400.0000     600.0000     0.223080     
 1009.463     2.763759     43.87963     9.462852            0     457.5114     506.3499     400.0000     600.0000     0.215997     
 1039.463     2.845894     40.88104     8.813645            0     463.8323     509.3291     400.0000     600.0000     0.209291     
 1069.463     2.928030     38.22192     8.237999            0     469.5264     512.0580     400.0000     600.0000     0.203261     
 1099.463     3.010165     35.95329     7.746866            0     474.9554     514.5830     400.0000     600.0000     0.197673     
 1129.463     3.092301     33.64724     7.247978            0     480.4937     517.9390     400.0000     600.0000     0.191409     
 1159.463     3.174437     31.62446     6.810425            0     485.6019     520.7929     400.0000     600.0000     0.185803     
 1189.463     3.256572     29.85949     6.428684            0     490.1729     523.3955     400.0000     600.0000     0.180842     
 1219.463     3.338707     28.14892     6.058890            0     494.5607     525.8780     400.0000     600.0000     0.175992     
 1249.463     3.420843     26.56594     5.716805            0     498.6321     528.1863     400.0000     600.0000     0.171460     
 1279.463     3.502979     25.10487     5.401155            0     502.4026     530.3298     400.0000     600.0000     0.167240     
 1309.463     3.585114     23.85315     5.130754            0     505.7397     532.2719     400.0000     600.0000     0.163583     
 1339.463     3.667250     22.62419     4.865415            0     508.9815     534.1403     400.0000     600.0000     0.159966     
 1369.463     3.749385     21.54678     4.632817            0     512.4256     536.3937     400.0000     600.0000     0.156010     
 1399.463     3.831521     20.49203     4.405237            0     515.7953     538.5896     400.0000     600.0000     0.152102     
 1429.463     3.913656     19.49795     4.190818            0     518.9749     540.6624     400.0000     600.0000     0.148387     
 1459.463     3.995792     18.65047     4.008035            0     521.7781     542.5207     400.0000     600.0000     0.145184     
 1489.463     4.077927     17.80542     3.825869            0     524.5338     544.3359     400.0000     600.0000     0.141973     
 1519.463     4.160063     16.99555     3.651355            0     527.1738     546.0746     400.0000     600.0000     0.138874     
 1549.463     4.242198     16.22625     3.485642            0     529.6857     547.7305     400.0000     600.0000     0.135911     
 1579.463     4.324334     15.49139     3.327399            0     532.0837     549.3108     400.0000     600.0000     0.133063     
 1609.463     4.406469     14.80251     3.179102            0     534.3370     550.7975     400.0000     600.0000     0.130377     
 1639.463     4.488605     14.20497     3.050478            0     536.3386     552.1339     400.0000     600.0000     0.128030     
 1669.463     4.570740     13.63246     2.927282            0     538.2567     553.4150     400.0000     600.0000     0.125770     
 1699.463     4.652876     13.08184     2.808832            0     540.1033     554.6492     400.0000     600.0000     0.123587     
 1729.463     4.735012     12.54804     2.694031            0     541.8901     555.8422     400.0000     600.0000     0.121462     
 1759.463     4.817147     12.07343     2.591976            0     543.6588     556.9933     400.0000     600.0000     0.119399     
 1789.463     4.899282     11.59533     2.489199            0     545.6792     558.5720     400.0000     600.0000     0.116788     
 1819.463     4.981418     11.15429     2.394411            0     547.6074     560.0096     400.0000     600.0000     0.114358     
 1849.463     5.063554     10.72017     2.301133            0     549.4974     561.4167     400.0000     600.0000     0.111953     
 1879.463     5.145689     10.30717     2.212407            0     551.2982     562.7581     400.0000     600.0000     0.109651     
 1909.463     5.227825     9.913425     2.127834            0     553.0161     564.0380     400.0000     600.0000     0.107445     
 1939.463     5.309960     9.591340     2.058659            0     554.4861     565.1493     400.0000     600.0000     0.105626     
 1969.463     5.392096     9.254231     1.986271            0     555.9908     566.2791     400.0000     600.0000     0.103716     
 1984.731     5.433899     9.253799     1.986178            0     555.9961     566.2776     400.0000     600.0000     0.103713     
 2000.000     5.475702     9.084513     1.949830            0     556.7504     566.8457     400.0000     600.0000     0.102752     
];

ecl_hyst = [1.000000     0.002738     169.7119     896.1907            0     1.761110     833.5385     400.0000     600.0000     0.473380     
 2.000000     0.005476     128.2557     881.4985            0     1.555968     458.2123     400.0000     600.0000     0.448140     
 3.503427     0.009592     88.26200     856.7268            0     1.330863     243.0015     400.0000     600.0000     0.417649     
 5.550900     0.015198     63.69086     741.6027            0     1.088335     263.8732     400.0000     600.0000     0.401604     
 8.293970     0.022708     48.22976     629.6628            0     0.886066     300.9022     400.0000     600.0000     0.391629     
 10.98866     0.030085     45.22617     514.7484            0     0.757215     348.4853     400.0000     600.0000     0.398673     
 13.86389     0.037957     43.93609     426.9549            0     0.662084     459.4542     400.0000     600.0000     0.407318     
 17.67901     0.048402     40.51453     349.1398            0     0.560795     430.7351     400.0000     600.0000     0.414162     
 21.26595     0.058223     36.41644     293.7767            0     0.478520     495.7558     400.0000     600.0000     0.417925     
 25.74385     0.070483     33.74975     230.8940            0     0.398772     512.4360     400.0000     600.0000     0.427916     
 31.58143     0.086465     33.05859     172.8326            0     0.334344     518.1602     400.0000     600.0000     0.444484     
 37.49076     0.102644     32.50660     143.0919            0     0.295667     530.9816     400.0000     600.0000     0.455496     
 44.91190     0.122962     32.34700     119.4087            0     0.263877     540.2664     400.0000     600.0000     0.466902     
 53.20219     0.145660     33.43137     102.7362            0     0.244611     546.0058     400.0000     600.0000     0.478530     
 63.20219     0.173038     37.47792     87.98530            0     0.238115     549.2493     400.0000     600.0000     0.494465     
 74.20219     0.203155     46.75122     71.39216            0     0.248480     547.3446     400.0000     600.0000     0.517877     
 85.20219     0.233271     65.49657     51.95324            0     0.285253     539.8599     400.0000     600.0000     0.545542     
 98.20219     0.268863     99.75588     26.22938            0     0.352565     525.5781     400.0000     600.0000     0.572272     
 112.2022     0.307193     134.5894     28.40513            0     0.433871     497.6049     400.0000     600.0000     0.578110     
 126.2022     0.345523     162.8602     34.92537            0     0.490469     480.7469     400.0000     600.0000     0.579106     
 142.2022     0.389328     189.2236     41.17210            0     0.525715     457.0238     400.0000     600.0000     0.580128     
 161.2022     0.441348     216.2157     47.71561            0     0.551130     432.2786     400.0000     600.0000     0.582085     
 178.2022     0.487891     234.7358     59.73257            0     0.561248     411.8539     400.0000     600.0000     0.581116     
 197.2022     0.539910     253.8395     58.15363            0     0.569022     395.1485     400.0000     600.0000     0.583348     
 216.2022     0.591929     267.2831     61.89236            0     0.574407     381.2083     400.0000     600.0000     0.583969     
 234.2022     0.641211     277.0409     65.29321            0     0.571039     370.8886     400.0000     600.0000     0.584470     
 254.2022     0.695968     285.5420     67.71046            0     0.564558     362.2163     400.0000     600.0000     0.585054     
 274.2022     0.750725     291.9853     69.56842            0     0.554921     355.6631     400.0000     600.0000     0.585590     
 292.2022     0.800006     296.3271     70.83209            0     0.544202     351.1973     400.0000     600.0000     0.586042     
 305.2022     0.835598     298.4484     71.47273            0     0.534701     348.3681     400.0000     600.0000     0.586359     
 321.2022     0.879404     300.1283     72.08549            0     0.521545     345.7973     400.0000     600.0000     0.586729     
 336.2022     0.920471     300.4008     72.69265            0     0.506968     343.9208     400.0000     600.0000     0.587017     
 348.2022     0.953326     300.3634     72.70113            0     0.495309     342.5970     400.0000     600.0000     0.587296     
 363.2022     0.994393     299.1531     72.34553            0     0.497443     340.9316     400.0000     600.0000     0.587198     
 378.2022     1.035461     287.2664     69.18744            0     1.055063     337.5924     400.0000     600.0000     0.573187     
 394.2022     1.079267     261.7539     63.36416            0     4.313313     330.9569     400.0000     600.0000     0.537716     
 415.2022     1.136762     218.6155     55.62018            0     17.46095     317.0628     400.0000     600.0000     0.473546     
 443.2022     1.213421     196.0360     47.90133            0     31.21227     300.2723     400.0000     600.0000     0.435522     
 469.2022     1.284606     179.7994     45.17506            0     43.99917     286.3854     400.0000     600.0000     0.408594     
 493.2022     1.350314     169.6587     42.01688            0     54.57543     275.2570     400.0000     600.0000     0.390275     
 518.2022     1.418760     159.3673     40.01522            0     64.89966     266.5190     400.0000     600.0000     0.373828     
 545.2022     1.492682     148.8275     37.47850            0     75.60542     258.8656     400.0000     600.0000     0.357763     
 572.2022     1.566604     140.5219     35.21793            0     85.29649     253.3470     400.0000     600.0000     0.344899     
 602.2022     1.648740     131.0156     33.03146            0     95.06551     249.0653     400.0000     600.0000     0.331635     
 632.2022     1.730875     121.7564     30.71565            0     104.7480     245.8319     400.0000     600.0000     0.318861     
 662.2022     1.813011     113.5900     28.62995            0     114.4710     243.9819     400.0000     600.0000     0.307027     
 692.2022     1.895146     106.5486     26.82141            0     122.8724     242.9923     400.0000     600.0000     0.296866     
 722.2022     1.977282     100.2352     25.23871            0     130.0950     242.4249     400.0000     600.0000     0.287983     
 752.2022     2.059417     94.98199     23.90533            0     136.1907     242.1916     400.0000     600.0000     0.280557     
 782.2022     2.141553     90.79261     22.83448            0     142.4045     242.0643     400.0000     600.0000     0.273828     
 812.2022     2.223689     86.32880     21.69016            0     148.0805     242.8907     400.0000     600.0000     0.267107     
 842.2022     2.305824     82.62177     20.74369            0     153.1856     243.5611     400.0000     600.0000     0.261304     
 872.2022     2.387959     78.97928     19.81205            0     158.1164     244.2963     400.0000     600.0000     0.255631     
 902.2022     2.470095     75.47956     18.91783            0     162.8746     245.0797     400.0000     600.0000     0.250157     
 932.2022     2.552231     72.10680     18.05601            0     167.4476     245.8542     400.0000     600.0000     0.244875     
 962.2022     2.634366     69.25848     17.32984            0     171.4166     246.6245     400.0000     600.0000     0.240365     
 992.2022     2.716502     66.82195     16.70257            0     175.5870     247.4772     400.0000     600.0000     0.235973     
 1022.202     2.798637     64.04380     16.00533            0     179.9734     248.7093     400.0000     600.0000     0.231059     
 1052.202     2.880773     61.55722     15.35426            0     183.9793     249.8268     400.0000     600.0000     0.226600     
 1082.202     2.962908     58.30206     14.54683            0     188.6722     251.0415     400.0000     600.0000     0.220943     
 1112.202     3.045044     55.32990     13.80925            0     193.0804     252.2006     400.0000     600.0000     0.215684     
 1142.202     3.127179     52.27494     13.05094            0     197.5481     253.3302     400.0000     600.0000     0.210253     
 1172.202     3.209315     49.24146     12.32400            0     202.0718     254.4942     400.0000     600.0000     0.204787     
 1202.202     3.291450     46.49918     11.56664            0     206.2477     255.5923     400.0000     600.0000     0.199754     
 1232.202     3.373586     44.07955     10.96405            0     210.6588     257.0475     400.0000     600.0000     0.194578     
 1262.202     3.455721     41.98729     10.45125            0     214.3407     258.5316     400.0000     600.0000     0.190098     
 1292.202     3.537857     40.45432     10.14272            0     216.8618     259.9870     400.0000     600.0000     0.186855     
 1322.202     3.619992     39.00728     9.781507            0     219.3445     261.1821     400.0000     600.0000     0.183721     
 1352.202     3.702128     37.64071     9.422792            0     221.7502     262.2602     400.0000     600.0000     0.180717     
 1382.202     3.784263     36.44411     9.126457            0     223.8046     263.2470     400.0000     600.0000     0.178087     
 1412.202     3.866399     35.32001     8.832363            0     225.7810     264.1335     400.0000     600.0000     0.175585     
 1442.202     3.948534     34.17849     8.542563            0     227.8065     264.9682     400.0000     600.0000     0.173026     
 1472.202     4.030670     32.99611     8.243551            0     229.9138     265.7861     400.0000     600.0000     0.170358     
 1502.202     4.112805     31.77775     7.936230            0     232.0914     266.6094     400.0000     600.0000     0.167590     
 1532.202     4.194941     30.52485     7.620930            0     234.3587     267.4568     400.0000     600.0000     0.164719     
 1562.202     4.277077     29.28631     7.309139            0     236.5832     268.3018     400.0000     600.0000     0.161867     
 1592.202     4.359212     28.18707     7.031639            0     238.8251     269.1272     400.0000     600.0000     0.159145     
 1622.202     4.441348     27.02103     6.743423            0     241.4691     270.3073     400.0000     600.0000     0.155811     
 1652.202     4.523483     25.88050     6.457417            0     244.0751     271.5117     400.0000     600.0000     0.152514     
 1682.202     4.605618     24.72449     6.167192            0     246.7145     272.7846     400.0000     600.0000     0.149141     
 1712.202     4.687754     23.60893     5.886278            0     249.2252     274.0497     400.0000     600.0000     0.145865     
 1742.202     4.769890     22.61416     5.635310            0     251.4524     275.2438     400.0000     600.0000     0.142920     
 1772.202     4.852025     21.59880     5.379407            0     253.7295     276.4308     400.0000     600.0000     0.139889     
 1802.202     4.934161     20.61924     5.132735            0     255.9269     277.5792     400.0000     600.0000     0.136939     
 1832.202     5.016296     19.66305     4.892646            0     258.0978     278.7124     400.0000     600.0000     0.134032     
 1862.202     5.098432     18.76051     4.665873            0     260.1287     279.7928     400.0000     600.0000     0.131270     
 1892.202     5.180567     17.95810     4.463834            0     261.9348     280.7979     400.0000     600.0000     0.128796     
 1922.202     5.262703     17.95334     4.469824            0     261.9449     280.8013     400.0000     600.0000     0.128784     
 1952.202     5.344838     17.16781     4.265226            0     263.7207     281.7638     400.0000     600.0000     0.126342     
 1976.101     5.410270     16.39920     4.072286            0     265.4625     282.6940     400.0000     600.0000     0.123939     
 2000.000     5.475702     15.81135     3.926921            0     266.7951     283.4104     400.0000     600.0000     0.122091     
];
gprsProd = [0         400         0           0           0         
1         400         981.74561   187.283     0.000735156
2.19524   400         962.90746   133.195     0.000895407
4.12843   400         914.4926    82.3194     0.000981266
5.59961   400         845.52467   59.538      0.000984243
8.38291   400         690.68372   48.2705     0.000934058
12.2913   400         512.99053   47.0004     0.000847652
17.1896   400         388.48768   42.3603     0.000741395
23.1084   400         299.6021    35.2175     0.000623178
30.7469   400         211.74068   32.501      0.000512148
39.2526   400         149.81065   34.152      0.00044375
49.4021   400         119.66661   36.4423     0.000405846
61.6047   400         96.961262   42.3083     0.000391299
76.9664   400         72.301985   60.4008     0.000416267
95.5038   400         45.40345    103.709     0.000478302
115.504   400         35.615191   153.028     0.000482604
135.504   400         41.351447   190.249     0.000415124
155.504   400         48.659792   219.399     0.00031959
175.504   400         54.70534    242.698     0.000224456
195.504   400         59.55723    260.957     0.000144647
215.504   400         63.734703   274.738     8.67984e-005
235.504   400         66.895719   285.295     4.78119e-005
255.504   400         69.19909    293.298     2.43756e-005
275.504   400         70.924246   299.223     1.28636e-005
295.504   400         72.203617   303.576     9.52562e-006
315.504   400         73.20312    306.594     1.22208e-005
335.504   400         74.06169    308.034     2.08312e-005
355.504   400         74.315817   308.58      3.17919e-005
375.504   400         74.349341   308.281     4.38399e-005
395.504   400         74.00604    306.976     0.00315687
415.504   400         72.616733   301.912     0.14688   
435.504   400         66.137119   276.609     1.92892   
455.504   400         57.689867   240.933     11.3929   
475.504   400         51.563945   213.716     25.0736   
495.504   400         47.888974   196.87      37.9765   
515.504   400         45.39286    185.438     48.6898   
535.504   400         43.392686   176.419     58.4799   
555.504   400         41.393567   167.741     67.5713   
575.504   400         39.50974    159.677     77.0913   
595.504   400         37.565424   151.571     86.2593   
615.504   400         35.895059   144.586     93.9764   
635.504   400         34.418525   138.434     101.305   
655.504   400         32.904213   132.249     108.491   
675.504   400         31.351202   125.979     115.571   
695.504   400         29.822463   119.845     122.448   
715.504   400         28.422015   114.23      129.232   
735.504   400         27.171546   109.236     135.495   
755.504   400         26.041909   104.749     141.086   
775.504   400         25.017173   100.688     146.126   
795.504   400         24.084532   96.9976     150.706   
815.504   400         23.222212   93.587      154.945   
835.504   400         22.430191   90.4522     159.14    
855.504   400         21.684787   87.5046     163.292   
875.504   400         20.963592   84.66       167.286   
895.504   400         20.266502   81.9129     171.161   
915.504   400         19.591262   79.2501     174.922   
935.504   400         18.939596   76.6813     178.591   
955.504   400         18.308921   74.1919     182.155   
975.504   400         17.702893   71.7998     185.604   
995.504   400         17.12157    69.502      188.919   
1015.5    400         16.579079   67.3534     192.291   
1035.5    400         16.061618   65.3077     195.576   
1055.5    400         15.560577   63.3295     198.718   
1075.5    400         15.233213   61.5025     201.34    
1095.5    400         14.793732   59.5717     204.127   
1115.5    400         14.261461   57.4773     207.213   
1135.5    400         13.699351   55.2567     210.521   
1155.5    400         13.126853   52.9846     213.937   
1175.5    400         12.554235   50.7054     217.359   
1195.5    400         11.997965   48.4884     220.713   
1215.5    400         11.492937   46.456      224.034   
1235.5    400         11.042604   44.6523     226.968   
1255.5    400         10.640395   43.0576     229.55    
1275.5    400         10.278954   41.6276     231.843   
1295.5    400         9.9497363   40.3253     233.922   
1315.5    400         9.6582347   39.1709     235.74    
1335.5    400         9.3951475   38.1294     237.391   
1355.5    400         9.1515804   37.162      238.941   
1375.5    400         8.9183761   36.2336     240.451   
1395.5    400         8.6904108   35.323      241.956   
1415.5    400         8.464387    34.4158     243.477   
1435.5    400         8.2388167   33.5083     245.014   
1455.5    400         8.0146545   32.6057     246.572   
1475.5    400         7.7913065   31.7035     248.146   
1495.5    400         7.5672321   30.7982     249.735   
1515.5    400         7.3472396   29.9011     251.417   
1535.5    400         7.1288427   29.0109     253.164   
1555.5    400         6.9095028   28.1214     254.901   
1575.5    400         6.6932156   27.2463     256.625   
1595.5    400         6.4797594   26.3825     258.329   
1615.5    400         6.2694162   25.5334     260.009   
1635.5    400         6.063307    24.7012     261.661   
1655.5    400         5.8617634   23.8869     263.282   
1675.5    400         5.664992    23.0918     264.871   
1695.5    400         5.4753565   22.3272     266.422   
1715.5    400         5.292402    21.5883     267.93    
1735.5    400         5.1151193   20.8719     269.398   
1755.5    400         4.9432397   20.1768     270.829   
1775.5    400         4.7766884   19.5034     272.222   
1795.5    400         4.6159108   18.8539     273.574   
1815.5    400         4.4611985   18.2276     274.883   
1835.5    400         4.3135525   17.6303     276.152   
1855.5    400         4.1715789   17.0552     277.381   
1875.5    400         4.0344376   16.4994     278.575   
1895.5    400         3.9063733   15.9709     279.83    
1915.5    400         3.7801776   15.4593     281.042   
1935.5    400         3.6583896   14.9645     282.209   
1955.5    400         3.5406477   14.4866     283.337   
1975.5    400         3.4269186   14.0252     284.428   
1995.5    400         3.3175708   13.5819     285.483   
2000      400         3.2924065   13.4841     285.719   
];

%   t       BHP	     q(Gas)       q(Oil)    q(Water)
% (days)   (psia)    (MSCF/day)   (STB/day)  (STB/day)
gprsInj = [0         600         0           0           0         
1         600         0           0           -532.727  
2.19524   600         0           0           -287.493  
4.12843   600         0           0           -274.62   
5.59961   600         0           0           -294.534  
8.38291   600         0           0           -343.95   
12.2913   600         0           0           -413.64   
17.1896   600         0           0           -477.225  
23.1084   600         0           0           -527.877  
30.7469   600         0           0           -562.894  
39.2526   600         0           0           -578.124  
49.4021   600         0           0           -582.162  
61.6047   600         0           0           -578.022  
76.9664   600         0           0           -563.904  
95.5038   600         0           0           -536.158  
115.504   600         0           0           -500.97   
135.504   600         0           0           -467.804  
155.504   600         0           0           -439.383  
175.504   600         0           0           -415.931  
195.504   600         0           0           -396.963  
215.504   600         0           0           -381.998  
235.504   600         0           0           -370.356  
255.504   600         0           0           -361.364  
275.504   600         0           0           -354.5    
295.504   600         0           0           -349.318  
315.504   600         0           0           -345.47   
335.504   600         0           0           -342.648  
355.504   600         0           0           -340.481  
375.504   600         0           0           -338.696  
395.504   600         0           0           -336.952  
415.504   600         0           0           -334.493  
435.504   600         0           0           -328.038  
455.504   600         0           0           -317.446  
475.504   600         0           0           -305.43   
495.504   600         0           0           -294.233  
515.504   600         0           0           -284.639  
535.504   600         0           0           -276.821  
555.504   600         0           0           -270.46   
575.504   600         0           0           -265.49   
595.504   600         0           0           -261.582  
615.504   600         0           0           -258.604  
635.504   600         0           0           -256.467  
655.504   600         0           0           -254.988  
675.504   600         0           0           -253.989  
695.504   600         0           0           -253.356  
715.504   600         0           0           -253.086  
735.504   600         0           0           -253.151  
755.504   600         0           0           -253.418  
775.504   600         0           0           -253.802  
795.504   600         0           0           -254.241  
815.504   600         0           0           -254.71   
835.504   600         0           0           -255.259  
855.504   600         0           0           -255.911  
875.504   600         0           0           -256.632  
895.504   600         0           0           -257.401  
915.504   600         0           0           -258.192  
935.504   600         0           0           -259.007  
955.504   600         0           0           -259.829  
975.504   600         0           0           -260.652  
995.504   600         0           0           -261.466  
1015.5    600         0           0           -262.327  
1035.5    600         0           0           -263.231  
1055.5    600         0           0           -264.143  
1075.5    600         0           0           -265.153  
1095.5    600         0           0           -266.138  
1115.5    600         0           0           -267.071  
1135.5    600         0           0           -267.983  
1155.5    600         0           0           -268.901  
1175.5    600         0           0           -269.825  
1195.5    600         0           0           -270.768  
1215.5    600         0           0           -271.781  
1235.5    600         0           0           -272.845  
1255.5    600         0           0           -273.867  
1275.5    600         0           0           -274.822  
1295.5    600         0           0           -275.706  
1315.5    600         0           0           -276.528  
1335.5    600         0           0           -277.276  
1355.5    600         0           0           -277.97   
1375.5    600         0           0           -278.609  
1395.5    600         0           0           -279.213  
1415.5    600         0           0           -279.799  
1435.5    600         0           0           -280.377  
1455.5    600         0           0           -280.956  
1475.5    600         0           0           -281.541  
1495.5    600         0           0           -282.133  
1515.5    600         0           0           -282.761  
1535.5    600         0           0           -283.437  
1555.5    600         0           0           -284.145  
1575.5    600         0           0           -284.874  
1595.5    600         0           0           -285.615  
1615.5    600         0           0           -286.362  
1635.5    600         0           0           -287.109  
1655.5    600         0           0           -287.852  
1675.5    600         0           0           -288.589  
1695.5    600         0           0           -289.32   
1715.5    600         0           0           -290.042  
1735.5    600         0           0           -290.753  
1755.5    600         0           0           -291.452  
1775.5    600         0           0           -292.138  
1795.5    600         0           0           -292.811  
1815.5    600         0           0           -293.469  
1835.5    600         0           0           -294.115  
1855.5    600         0           0           -294.746  
1875.5    600         0           0           -295.363  
1895.5    600         0           0           -295.999  
1915.5    600         0           0           -296.641  
1935.5    600         0           0           -297.279  
1955.5    600         0           0           -297.907  
1975.5    600         0           0           -298.522  
1995.5    600         0           0           -299.123  
2000      600         0           0           -299.257  
];
ecl(:,1) = ecl(:,1)./365;
%ecl_stone(:,1) = ecl_stone(:,1)./365;
ecl_hyst(:,1) = ecl_hyst(:,1)./365;
gprsProd(:,1) = gprsProd(:,1)./365;
gprsInj(:,1) = gprsInj(:,1)./365;
gprsProdOld(:,1) = gprsProdOld(:,1)./365;
gprsInjOld(:,1) = gprsInjOld(:,1)./365;

% gprsProdOld
% gprsInjOld
figure
plot(ecl(:,1), ecl(:,3),gprsProdOld(:,1), gprsProdOld(:,4),'--<',...
    ecl_hyst(:,1), ecl_hyst(:,3),gprsProd(:,1), gprsProd(:,4), '--*')
title('PROD OIL RATE')
legend('Eclipse Default','GPRS Default','Eclipse Hysteresis','GPRS Hysteresis')
xlabel('time/year')
ylabel('ORATE/STB per day')

MW_water = 1;

figure
plot(ecl(:,1), ecl(:,6),gprsProdOld(:,1), gprsProdOld(:,5).*MW_water,'--<',...
    ecl_hyst(:,1), ecl_hyst(:,6),gprsProd(:,1), gprsProd(:,5).*MW_water, '--*')
title('PROD WATER RATE')
legend('Eclipse Default','GPRS Default','Eclipse Hysteresis','GPRS Hysteresis')
xlabel('time/year')
ylabel('WRATE/STB per day')


figure
plot(ecl(:,1), ecl(:,4),gprsProdOld(:,1), gprsProdOld(:,3),'--<',... 
    ecl_hyst(:,1),ecl_hyst(:,4), gprsProd(:,1), gprsProd(:,3),'--*')
title('PROD GAS RATE')
legend('Eclipse Default','GPRS Default','Eclipse Hysteresis','GPRS Hysteresis')
xlabel('time/year')
ylabel('GRATE/MSCF per day')

figure
plot(ecl(:,1), ecl(:,7),gprsInjOld(:,1), gprsInjOld(:,5).*(-MW_water),'--<', ...
    ecl_hyst(:,1), ecl_hyst(:,7), gprsInj(:,1), gprsInj(:,5).*(-MW_water), '--*')
title('INJ WATER RATE')
legend('Eclipse Default','GPRS Default','Eclipse Hysteresis','GPRS Hysteresis')
xlabel('time/year')
ylabel('INJ WATER RATE/STB per day')