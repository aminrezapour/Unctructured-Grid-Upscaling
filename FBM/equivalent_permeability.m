function k = equivalent_permeability(a_0,k_0,areas)

   
    num = size(areas,1);
    
    
    myfun = @(K,k0,k1,k2,k3,k4,k5,k6,k7,k8,k9,k10,...
                   k11,k12,k13,k14,k15,k16,k17,k18,k19,k20,...
                   k21,k22,k23,k24,k25,k26,k27,k28,k29,k30,A,a0,...
                   a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,...
                   a11,a12,a13,a14,a15,a16,a17,a18,a19,a20,...
                   a21,a22,a23,a24,a25,a26,a27,a28,a29,a30) (a0/A)*(k0-K)/(k0+K) + ...
         (a1/A)*(k1-K)/(k1+K) + (a2/A)*(k2-K)/(k2+K) + (a3/A)*(k3-K)/(k3+K) + ...
         (a4/A)*(k4-K)/(k4+K) + (a5/A)*(k5-K)/(k5+K) + (a6/A)*(k6-K)/(k6+K) + ...
         (a7/A)*(k7-K)/(k7+K) + (a8/A)*(k8-K)/(k8+K) + (a9/A)*(k9-K)/(k9+K) + ...
         (a10/A)*(k10-K)/(k10+K) + (a11/A)*(k11-K)/(k11+K) + (a12/A)*(k12-K)/(k12+K) + ...
         (a13/A)*(k13-K)/(k13+K) + (a14/A)*(k14-K)/(k14+K) + (a15/A)*(k15-K)/(k15+K) + ...
         (a16/A)*(k16-K)/(k16+K) + (a17/A)*(k17-K)/(k17+K) + (a18/A)*(k18-K)/(k18+K) + ...
         (a19/A)*(k19-K)/(k19+K) + (a20/A)*(k20-K)/(k20+K) + (a21/A)*(k21-K)/(k21+K) + ...
         (a22/A)*(k22-K)/(k22+K) + (a23/A)*(k23-K)/(k23+K) + (a24/A)*(k24-K)/(k24+K) + ...
         (a25/A)*(k25-K)/(k25+K) + (a26/A)*(k26-K)/(k26+K) + (a27/A)*(k27-K)/(k27+K) + ...
         (a28/A)*(k28-K)/(k28+K) + (a29/A)*(k29-K)/(k29+K) + (a30/A)*(k30-K)/(k30+K);
     
    k0 = k_0/1000;a0 = a_0;
    A = a_0 + sum(areas(:,1));
    
    k_all = [];
    a_all = [];
    for i = 1:num
       k_all(i) = areas(i,2)/1000;
       a_all(i) = areas(i,1);
    end
    for j = i+1:30
       k_all(j) = 0;
       a_all(j) = 0;
    end

    fun = @(x) myfun(x,k0,k_all(1),k_all(2),k_all(3),k_all(4),k_all(5),...
                          k_all(6),k_all(7),k_all(8),k_all(9),k_all(10),...
                          k_all(11),k_all(12),k_all(13),k_all(14),k_all(15),...
                          k_all(16),k_all(17),k_all(18),k_all(19),k_all(20),...
                          k_all(21),k_all(22),k_all(23),k_all(24),k_all(25),...
                          k_all(26),k_all(27),k_all(28),k_all(29),k_all(30),...
                     A,a0,a_all(1),a_all(2),a_all(3),a_all(4),a_all(5),...
                          a_all(6),a_all(7),a_all(8),a_all(9),a_all(10),...
                          a_all(11),a_all(12),a_all(13),a_all(14),a_all(15),...
                          a_all(16),a_all(17),a_all(18),a_all(19),a_all(20),...
                          a_all(21),a_all(22),a_all(23),a_all(24),a_all(25),...
                          a_all(26),a_all(27),a_all(28),a_all(29),a_all(30));
    x = fzero(fun,k_0/1000);
    
    k = 1000*x;
end

